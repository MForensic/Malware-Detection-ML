function p = mltivarGaussian(X, m, Sig2)


k = length(m);

if (size(Sig2, 2) == 1) || (size(Sig2, 1) == 1)
    Sig2 = diag(Sig2);
end

X = bsxfun(@minus, X, m(:)');


p = log (2 * pi) ^ (- k / 2) * det(Sig2) ^ (-0.5) * ...
    exp(-0.5 * sum(bsxfun(@times, X * pinv(Sig2), X), 2));

end

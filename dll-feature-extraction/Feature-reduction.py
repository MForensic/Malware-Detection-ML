import pandas as pd
import pickle
import re
from collections import Counter

# files = 'test.xlsx'
# xl_workbook = pd.ExcelFile(files)  # Load the excel workbook
# df = xl_workbook.parse("Sheet")  # Parse the sheet into a dataframe
       
# df.insert(6,'new',1000)
# df.to_csv(files)


#def valueGenerator(test_file):
files = 'test.xlsx'
xl_workbook = pd.ExcelFile(files)  # Load the excel workbook
df = xl_workbook.parse("test")  # Parse the sheet into a dataframe
PTest_List = df['Path'].tolist()  # Cast the desired column into a python list
PTest_List = [item for item in PTest_List if str(item) != 'nan'] # cleaning items with nan value
PID_List = df['Pid'].tolist() # process id column

for x,i in enumerate(PTest_List):
	PTest_List[x]=re.sub(r'.*C:','C:',i)
	if re.search("C:", PTest_List[x]):
		PTest_List[x]=PTest_List[x]

print (len(PTest_List))
print (len(PID_List))
#print (set(Test_List))
with open("dictfile", "rb") as mafile:
	manewD=pickle.load(mafile)
		

	#for k in manewD.keys():
#	Normal = set(PTest_List).intersection(manewD.keys())  # Normal loaded dlls
	
	#lPtest= Counter(PTest_List)
	#lDic = Counter(list(manewD.keys()))
	suspecious = []
	#suspecious = [j for j in PTest_List if j not in manewD.keys()]
	for x, j in enumerate(PTest_List):
		if (j not in manewD.keys()):
				print (x)
				print (PID_List[x])






















	print ("Suspicious", suspecious)
#	print(manewD.keys())
